<div class="products-container">
  <!-- Header -->
  <div class="page-header">
    <h1>Manage Products</h1>
    <div class="header-actions">
      <mat-form-field appearance="outline" class="search-field">
        <input matInput
              [(ngModel)]="searchQuery"
              (ngModelChange)="applyFilter()"
              placeholder="Search Products...">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
      <button mat-raised-button color="primary" (click)="addProduct()">
        <mat-icon>add</mat-icon>
        Add Product
      </button>
    </div>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading products...</p>
    </div>
  } @else {
    <!-- Products Table -->
    <div class="table-container">
      <table mat-table [dataSource]="dataSource" class="orders-table">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Product Name</th>
          <td mat-cell *matCellDef="let product">
            <strong>{{ product.name }}</strong>
          </td>
        </ng-container>

        <!-- Product Type Column -->
        <ng-container matColumnDef="productType">
          <th mat-header-cell *matHeaderCellDef>Type</th>
          <td mat-cell *matCellDef="let product">
            <span class="type-badge" [class]="'type-' + product.productType">
              {{ getProductTypeLabel(product.productType) }}
            </span>
          </td>
        </ng-container>

        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let product" class="description-cell">
            {{ product.description }}
          </td>
        </ng-container>

        <!-- Variants Column -->
        <ng-container matColumnDef="variants">
          <th mat-header-cell *matHeaderCellDef>Variants</th>
          <td mat-cell *matCellDef="let product">
            <div class="variants-info">
              <div class="variant-count">{{ product.variants.length }} variant(s)</div>
            </div>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let product">
            <span class="status-badge" [style.color]="getStatusColor(product.isActive)">
              {{ product.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let product">
            <button mat-icon-button color="accent" [title]="'Edit ' + product.name" (click)="editProduct(product)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" [title]="'Delete ' + product.name" (click)="deleteProduct(product)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <!-- No results overlay -->
      @if (dataSource.data.length === 0) {
        <div class="no-results-overlay">
          <div class="no-results-content">
            No products found.
          </div>
        </div>
      }

      <!-- Pagination -->
      <div class="pagination-container">
        <mat-paginator
          [pageSizeOptions]="[5, 10, 25, 100]"
          [pageSize]="10"
          [length]="dataSource.data.length"
          showFirstLastButtons>
        </mat-paginator>
      </div>
    </div>
  }
</div>
